<main class="container my-4">
  <h2>Order Details</h2>
  
  <table class="table table-bordered">
    <tbody>
      <tr>
        <th>Order Number:</th>
        <td><%= @order.id %></td>
      </tr>
      <tr>
        <th>Street Address:</th>
        <td><%= @order.address_street.presence || @order.address&.street || 'Not specified' %></td>
      </tr>
      <tr>
        <th>City:</th>
        <td><%= @order.address_city.presence || @order.address&.city || 'Not specified' %></td>
      </tr>
      <tr>
        <th>Zip Code:</th>
        <td><%= @order.address_zip_code.presence || @order.address&.postal_code || 'Not specified' %></td>
      </tr>
      <tr>
        <th>Province:</th>
        <td><%= @order.province.presence || @order.address&.province&.name || 'Not specified' %></td>
      </tr>
      <tr>
        <th>Total Before Taxes:</th>
        <td><%= number_to_currency(@order.subtotal) %></td>
      </tr>
      <tr>
        <th>GST:</th>
        <td><%= number_to_currency(@order.gst) %></td>
      </tr>
      <tr>
        <th>PST:</th>
        <td><%= number_to_currency(@order.pst) %></td>
      </tr>
      <tr>
        <th>HST:</th>
        <td><%= number_to_currency(@order.hst) %></td>
      </tr>
      <tr>
        <th>Total After Taxes:</th>
        <td><%= number_to_currency(@order.total_price) %></td>
      </tr>
    </tbody>
  </table>

  <h3>Items in Your Order</h3>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Product</th>
        <th>Quantity</th>
        <th>Price</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <% if @order.order_items.present? %>
        <% @order.order_items.each do |item| %>
          <tr>
            <td><%= item.product.name %></td>
            <td><%= item.quantity %></td>
            <td><%= number_to_currency(item.product.sale_price || item.product.price) %></td>
            <td><%= number_to_currency((item.product.sale_price || item.product.price) * item.quantity) %></td>
          </tr>
        <% end %>
      <% else %>
        <tr>
          <td colspan="4">No items in order</td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <div class="mt-4">
    <%= link_to 'Back to Orders', orders_path, class: 'btn btn-primary' %>
    <%= link_to 'Continue Shopping', root_path, class: 'btn btn-secondary' %>
  </div>
</main>
